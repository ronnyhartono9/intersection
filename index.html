<html>
    <meta name="theme-color"content="chocolate"/>
    <meta name="viewport"content="width=device-width,initial-scale=1"> 
 <head>
    <script type="text/javascript">
        const numSteps = 20.0;

        let boxElement;let gel;
        let prevRatio = 0.0;
        let increasingColor = "rgba(40, 40, 190, ratio)";
        let decreasingColor = "rgba(190, 40, 40, ratio)";

        // Set things up
        window.addEventListener("load", (event) => {
        boxElement = document.querySelector("#h"); 
        gel = document.querySelector("#g"); 
        createObserver();
        }, false);

        function createObserver() {
            let observer; let gobserver;

            let options = {
                root: null,
                rootMargin: "0px",
                threshold: buildThresholdList()
            };

            let options2 = {
                root: null,
                rootMargin: "0px",
                threshold: buildThresholdList2()
            };

            observer = new IntersectionObserver(handleIntersect, options);
            observer.observe(boxElement);

            gobserver = new IntersectionObserver(handleIntersect2, options2);
            gobserver.observe(gel);

        }

        function buildThresholdList() {
            let thresholds = [];
            let numSteps = 20;

            for (let i=1.0; i<=numSteps; i++) {
                let ratio = i/numSteps;
                thresholds.push(ratio);
            }

            thresholds.push(0);
            return thresholds;
        }

        function handleIntersect(entries, observer) {
            entries.forEach((entry) => {
            
                if (entry.intersectionRatio > prevRatio) {
                entry.target.style.backgroundColor = increasingColor.replace("ratio", entry.intersectionRatio); 
                } else {
                entry.target.style.backgroundColor = decreasingColor.replace("ratio", entry.intersectionRatio);
                } 
                    document.getElementById("s").innerHTML ="kotak 2 ratio =   "+entry.intersectionRatio;
                prevRatio = entry.intersectionRatio;
            });
        }

        function buildThresholdList2() {
            let thresholds = [];
            let numSteps = 20;

            for (let i=1.0; i<=numSteps; i++) {
                let ratio = i/numSteps;
                thresholds.push(ratio);
            }

            thresholds.push(0);
            return thresholds;
        }

        function handleIntersect2(entries, observer) {
            entries.forEach((entry) => {
            
                if (entry.intersectionRatio > prevRatio) {
                entry.target.style.backgroundColor = increasingColor.replace("ratio", entry.intersectionRatio); 
                } else {
                entry.target.style.backgroundColor = decreasingColor.replace("ratio", entry.intersectionRatio);
                } 
                    document.getElementById("r").innerHTML ="kotak 1 ratio =   "+entry.intersectionRatio;
                prevRatio = entry.intersectionRatio;
            });
        } 

        var p;
        const divs = ["r1", "r2", "", " ", " "];


        function ketarik(){
            var rr = document.getElementById('r').innerHTML.replace("kotak 1 ratio =   ", "");
            var ss = document.getElementById('s').innerHTML.replace("kotak 2 ratio =   ", "");
       
            if(rr > ss ){
                alert( "ketarik ke kotak 1");
                p="r1"; 
            }else{
                alert( "ketarik ke kotak 2");
                p="r2"; 
            }
        }

        function test(){
             ketarik();  
             document.getElementById('hope').style.left =  document.getElementById('thope').rows[0].cells[1].offsetWidth *  divs.indexOf(p)     +"px";
             document.getElementById('hope').scrollIntoView();
  
        }
    </script>
 </head>

 <body>
     <a id="r" >  </a><br>
     <a id="s" > </a>
     <a href="#box">peneken</a>
     <a> prev</a> 
     <a> next</a>
     <a onclick="ketarik()"> magnet </a>
     <br> 
     <a onclick="test()">tombol</a>
     <div id="awak" style=" overflow: scroll;  scroll-behavior: smooth; background-color: beige; width: 100%; height: 80%;"> 
        <div id="panel" style=" background-color: pink;  width: 200%; height: 100%;">
            <table id="thope" border="1" style="width: 100%;">                
                <tr>
                    <td align="center">
                        <div id="r1" style=" position: relative;    background-color: yellow;">1
                            <div id="g" style=" position: relative; background-color: green; width: 450px;height: 400;">

                            </div>
                        </div>
                       
                    </td>
                    <td align="center">
                        <div id="r2" style=" position: relative;  background-color: orange;">2
                            <div id="h" style=" position: relative; background-color: blue; width: 450px;height: 400;"> 
                            </div> 
                        </div>
                        

                    </td> 
                    <td align="center">3
                        <div id="i" style="background-color: blue; width: 450px;height: 400;">

                        </div>                         
                    </td>

                </tr>
            </table>

           
        </div>
                    <div id="hope" style=" position: relative;  background-color: purple; width: 100%;">
                        dd
                </div>
     </div>
        <script>
            var i=0;
            var timer = null;
            elemst = document.getElementById("awak");
            var poscawal = 0;         
            elemst.addEventListener('scroll', function() {
                if(i==0){
                    poscawal = elemst.scrollLeft;
                }
                    i++;
                    if(timer !== null) {
                        clearTimeout(timer);
                    }
                    timer = setTimeout(function() { 
                          if( poscawal > 0 ){
                           //alert(" sc awal "+ poscawal +" sc akhir"+elemst.scrollLeft); 
                          }                         
                          poscawal=0; 
                      i=0;
                    }, 250);
                }, false);

        </script>
 </body> 
</html>



